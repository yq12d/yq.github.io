<!-- filename: light_tech_nexus_bilingual.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS | Light Command Node</title>
    <!-- ÂºïÂÖ•ÁßëÊäÄÊÑüÂ≠ó‰Ωì (Ëã±ÊñáÊï∞Â≠ó‰∏ìÁî®) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* ‰∫ÆËâ≤ÁßëÊäÄ‰∏ªÈ¢òÈÖçËâ≤ */
            --bg-color: #f0f2f5;
            --bg-grid: #e2e8f0;
            --primary-color: #0066ff; /* ÁßëÊäÄËìù */
            --secondary-color: #5e17eb; /* Ê∑±Á¥´ */
            --accent-color: #ff6b00; /* Ë≠¶ÂëäÊ©ô */
            
            --text-main: #1a202c; 
            --text-sub: #4a5568;
            
            --card-bg: rgba(255, 255, 255, 0.75);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            min-height: 100vh;
            overflow-x: hidden;
            /* Â≠ó‰ΩìÊ†àÔºöËã±ÊñáÁßëÊäÄÂ≠ó‰Ωì -> ‰∏≠ÊñáÂæÆËΩØÈõÖÈªë/Á≥ªÁªüÂ≠ó‰Ωì */
            font-family: 'Share Tech Mono', 'Microsoft YaHei', 'PingFang SC', sans-serif;
            position: relative;
            background-image: 
                linear-gradient(var(--bg-grid) 1px, transparent 1px),
                linear-gradient(90deg, var(--bg-grid) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* 3D Á≤íÂ≠ê Canvas */
        #canvas-background {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            opacity: 0.6; 
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
            animation: slideUpFade 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        @keyframes slideUpFade {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Áªü‰∏ÄÁ≥ªÁªüÊñáÊú¨È£éÊ†º */
        .sys-text {
            text-transform: uppercase;
            letter-spacing: 1px;
            /* Ê†áÈ¢òÁ±ª‰ªçÁÑ∂‰ºòÂÖà‰ΩøÁî® Orbitron */
            font-family: 'Orbitron', 'Microsoft YaHei', sans-serif;
        }
        
        .sys-bracket::before { content: '['; color: var(--primary-color); margin-right: 5px; }
        .sys-bracket::after { content: ']'; color: var(--primary-color); margin-left: 5px; }

        /* Â§¥ÈÉ®‰∏éËØ≠Ë®ÄÂàáÊç¢ */
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .lang-switch {
            cursor: pointer;
            font-family: 'Share Tech Mono', monospace;
            font-size: 14px;
            padding: 5px 10px;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            background: rgba(255,255,255,0.8);
            transition: 0.3s;
        }

        .lang-switch:hover {
            background: var(--primary-color);
            color: white;
        }

        .header-content {
            text-align: center;
            margin-bottom: 60px;
        }

        .clock {
            font-family: 'Orbitron', sans-serif; /* Êó∂Èó¥‰øùÊåÅÁ∫ØÊï∞Â≠óÂ≠ó‰Ωì */
            font-size: 5rem;
            font-weight: 700;
            color: var(--text-main);
            letter-spacing: 2px;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1); 
            margin-bottom: 5px;
            position: relative;
            display: inline-block;
        }

        .clock::after {
            content: '';
            position: absolute;
            bottom: 0; left: 0; width: 100%; height: 3px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
        }

        .date {
            color: var(--accent-color);
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* ÊêúÁ¥¢Âå∫ */
        .search-section { margin-bottom: 60px; text-align: center; }
        .search-container { max-width: 650px; margin: 0 auto; position: relative; }

        .search-box {
            width: 100%;
            padding: 18px 30px;
            border: 2px solid rgba(0, 102, 255, 0.1);
            border-radius: 4px; 
            font-size: 18px;
            background: rgba(255, 255, 255, 0.9);
            color: var(--text-main);
            outline: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            font-family: 'Share Tech Mono', 'Microsoft YaHei', sans-serif;
        }

        .search-box:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(0, 102, 255, 0.1);
            transform: scale(1.01);
        }

        /* ÊêúÁ¥¢Âä†ËΩΩÈÅÆÁΩ© */
        .search-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: none; 
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .loading-bar {
            width: 300px;
            height: 4px;
            background: #ddd;
            margin-top: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .loading-bar::after {
            content: '';
            position: absolute;
            top: 0; left: 0; height: 100%; width: 50%;
            background: var(--primary-color);
            animation: scan 1s infinite linear;
        }
        
        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }

        .search-engines {
            display: flex; gap: 15px; justify-content: center; margin-top: 20px;
        }

        .search-btn {
            padding: 8px 20px;
            background: white;
            border: 1px solid #cbd5e0;
            color: var(--text-sub);
            cursor: pointer;
            transition: 0.2s;
            font-weight: bold;
            font-family: 'Orbitron', 'Microsoft YaHei', sans-serif;
            font-size: 0.8rem;
            position: relative;
            overflow: hidden;
        }

        .search-btn::before {
            content: ''; position: absolute; top: 0; left: 0; width: 3px; height: 100%;
            background: var(--primary-color); transform: scaleY(0); transition: transform 0.2s;
        }

        .search-btn:hover, .search-btn.active {
            border-color: var(--primary-color); color: var(--primary-color); background: rgba(0, 102, 255, 0.05);
        }
        .search-btn:hover::before, .search-btn.active::before { transform: scaleY(1); }

        /* ÂØºËà™Âå∫ */
        .nav-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 30px; border-bottom: 1px solid #cbd5e0; padding-bottom: 15px;
        }

        .nav-title { font-family: 'Orbitron', 'Microsoft YaHei', sans-serif; font-size: 1.5rem; color: var(--text-main); }

        .control-btn {
            background: white; border: 1px solid var(--primary-color); color: var(--primary-color);
            padding: 8px 16px; cursor: pointer; transition: all 0.2s;
            font-family: 'Share Tech Mono', 'Microsoft YaHei', sans-serif; font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .control-btn:hover {
            background: var(--primary-color); color: white; transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 102, 255, 0.2);
        }

        .sort-select {
            padding: 8px; border: 1px solid #cbd5e0; background: white; color: var(--text-main);
            margin-right: 10px; font-family: 'Share Tech Mono', 'Microsoft YaHei', monospace;
        }

        /* Âç°ÁâáÁΩëÊ†º */
        .sites-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 25px;
        }

        .site-card {
            background: var(--card-bg); border: 1px solid white; border-radius: 12px;
            padding: 25px; text-align: center; cursor: pointer; position: relative; overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px); box-shadow: var(--glass-shadow);
        }

        .site-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 100%); z-index: 1;
        }
        
        .site-card::after {
            content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px;
            background: var(--primary-color); transform: scaleX(0); transition: transform 0.3s; transform-origin: left;
        }

        .site-card:hover {
            transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1); border-color: rgba(0, 102, 255, 0.3);
        }
        .site-card:hover::after { transform: scaleX(1); }

        .site-icon {
            width: 50px; height: 50px; margin: 0 auto 15px; border-radius: 12px;
            background: rgba(0, 102, 255, 0.05); display: flex; align-items: center; justify-content: center;
            font-size: 24px; color: var(--text-main); position: relative; z-index: 2;
            transition: 0.3s; border: 1px solid rgba(0, 102, 255, 0.1);
        }

        .site-card:hover .site-icon {
            background: var(--primary-color); color: white; box-shadow: 0 0 15px rgba(0, 102, 255, 0.3);
        }

        .site-name {
            font-family: 'Orbitron', 'Microsoft YaHei', sans-serif; font-weight: 700; font-size: 1rem;
            margin-bottom: 5px; color: var(--text-main); position: relative; z-index: 2;
        }

        .site-url {
            font-size: 12px; color: var(--text-sub); font-family: 'Share Tech Mono', monospace; position: relative; z-index: 2;
        }

        .add-site {
            background: rgba(255,255,255,0.3); border: 2px dashed #cbd5e0;
            display: flex; align-items: center; justify-content: center;
        }
        .add-site:hover { border-color: var(--accent-color); background: rgba(255, 107, 0, 0.05); }
        .add-icon { font-size: 3rem; color: #cbd5e0; transition: 0.3s; }
        .add-site:hover .add-icon { color: var(--accent-color); transform: rotate(90deg); }

        /* Ê®°ÊÄÅÊ°Ü */
        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0;
            width: 100%; height: 100%; background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(5px); opacity: 0; transition: opacity 0.3s ease;
        }
        .modal.active { display: block; opacity: 1; }
        .modal-content {
            background: #fff; margin: 10% auto; padding: 40px; border-radius: 16px;
            width: 90%; max-width: 450px; position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.1); border: 1px solid rgba(0, 102, 255, 0.2);
            transform: translateY(30px); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal.active .modal-content { transform: translateY(0); }

        .close { position: absolute; right: 20px; top: 20px; font-size: 24px; color: var(--text-sub); cursor: pointer; }
        .close:hover { color: var(--accent-color); }

        .form-group label { display: block; margin-bottom: 8px; color: var(--text-sub); font-weight: bold; }
        .form-group input {
            width: 100%; padding: 12px; margin-bottom: 20px; background: #f7fafc;
            border: 1px solid #e2e8f0; border-radius: 6px; color: var(--text-main);
            font-family: 'Share Tech Mono', 'Microsoft YaHei', monospace;
        }
        .form-group input:focus { outline: none; border-color: var(--primary-color); background: #fff; }

        .btn-primary {
            width: 100%; padding: 14px; background: var(--primary-color); color: white;
            border: none; border-radius: 6px; font-family: 'Orbitron', 'Microsoft YaHei', sans-serif;
            letter-spacing: 2px; cursor: pointer; transition: 0.2s; position: relative; overflow: hidden;
        }
        .btn-primary:active { transform: scale(0.98); }

        /* Â§©Ê∞î */
        .weather-widget {
            text-align: right; color: var(--text-sub); font-size: 0.9rem;
            border-right: 3px solid var(--accent-color); padding-right: 15px;
        }

        @media (max-width: 768px) {
            .clock { font-size: 3rem; }
            .nav-header { flex-direction: column; gap: 15px; }
            .weather-widget { border-right: none; border-bottom: 3px solid var(--accent-color); padding-bottom: 10px; margin-bottom: 20px; padding-right: 0; text-align: center;}
            .header-top { flex-direction: column-reverse; align-items: center; gap: 10px; }
        }
    </style>
</head>
<body>
    <canvas id="canvas-background"></canvas>

    <!-- ÊêúÁ¥¢Âä†ËΩΩÂä®ÁîªÈÅÆÁΩ© -->
    <div class="search-overlay" id="searchOverlay">
        <h2 class="sys-text" style="color: var(--primary-color); margin-bottom: 10px;" data-i18n="searching">RETRIEVING DATA...</h2>
        <div class="sys-text" style="font-size: 12px; color: var(--text-sub);" data-i18n="connecting">[CONNECTING TO EXTERNAL NODE]</div>
        <div class="loading-bar"></div>
    </div>

    <div class="container">
        <!-- È°∂ÈÉ®Ê†èÔºöÂ§©Ê∞î + ËØ≠Ë®ÄÂàáÊç¢ -->
        <div class="header-top">
            <div class="weather-widget" id="weather">
                <div class="sys-text" data-i18n="sysOnline">[SYSTEM ONLINE]</div>
                <div><span data-i18n="temp">TEMP</span>: 22¬∞C // <span data-i18n="env">LAB_ENV</span></div>
            </div>
            <button class="lang-switch" id="langToggle" onclick="toggleLanguage()">[ EN / ‰∏≠ ]</button>
        </div>

        <header class="header-content">
            <div class="clock sys-text" id="clock">00:00</div>
            <div class="date sys-bracket sys-text" id="date">LOADING...</div>
        </header>

        <section class="search-section">
            <div class="search-container">
                <!-- data-i18n-placeholder Áî®‰∫éÁâπÊÆäÂ§ÑÁêÜ input -->
                <input type="text" class="search-box" id="searchBox" placeholder=">> INPUT COMMAND OR SEARCH KEYWORD..." data-i18n-placeholder="searchPlaceholder" autocomplete="off"/>
            </div>
            <div class="search-engines">
                <button class="search-btn sys-text active" data-engine="google">GOOGLE</button>
                <button class="search-btn sys-text" data-engine="baidu" data-i18n="baidu">BAIDU</button>
                <button class="search-btn sys-text" data-engine="bing">BING</button>
                <button class="search-btn sys-text" data-engine="github">GITHUB</button>
            </div>
        </section>

        <section class="navigation">
            <div class="nav-header">
                <h2 class="nav-title sys-bracket" data-i18n="navTitle">LINK DATABASE</h2>
                <div class="nav-controls">
                    <select class="sort-select" id="sortSelect">
                        <option value="name" data-i18n="sortName">NAME (A-Z)</option>
                        <option value="url" data-i18n="sortUrl">URL</option>
                        <option value="date" data-i18n="sortDate">DATE ADDED</option>
                    </select>
                    <button class="control-btn sys-text" onclick="exportSites()" data-i18n="export">EXPORT</button>
                    <button class="control-btn sys-text" onclick="importSites()" data-i18n="import">IMPORT</button>
                    <button class="control-btn sys-text" style="border-color: var(--accent-color); color: var(--accent-color);" onclick="clearAllSites()" data-i18n="purge">PURGE</button>
                </div>
            </div>
            
            <div class="sites-grid" id="sitesGrid">
                <div class="site-card add-site" onclick="openModal()">
                    <div class="add-icon">+</div>
                </div>
            </div>
        </section>
    </div>

    <!-- Modal -->
    <div id="siteModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 class="sys-text sys-bracket" style="color: var(--primary-color); margin-bottom: 20px;" data-i18n="addNode">ADD NODE</h2>
            <form id="siteForm">
                <div class="form-group">
                    <label data-i18n="labelName">IDENTIFIER (Name):</label>
                    <input type="text" id="siteName" name="siteName" required>
                </div>
                <div class="form-group">
                    <label data-i18n="labelUrl">COORDINATES (URL):</label>
                    <input type="url" id="siteUrl" name="siteUrl" placeholder="https://..." required>
                </div>
                <div class="form-group">
                    <label data-i18n="labelIcon">SYMBOL (Emoji):</label>
                    <input type="text" id="siteIcon" name="siteIcon" placeholder="üß¨">
                </div>
                <button type="submit" class="btn-primary sys-text" data-i18n="btnExecute">EXECUTE PROTOCOL</button>
            </form>
        </div>
    </div>

    <script>
        // ==========================================
        // Â§öËØ≠Ë®ÄÊîØÊåÅ (I18n)
        // ==========================================
        const translations = {
            en: {
                sysOnline: "[SYSTEM ONLINE]",
                temp: "TEMP",
                env: "LAB_ENV",
                searchPlaceholder: ">> INPUT COMMAND OR SEARCH KEYWORD...",
                searching: "RETRIEVING DATA...",
                connecting: "[CONNECTING TO EXTERNAL NODE]",
                navTitle: "LINK DATABASE",
                baidu: "BAIDU",
                sortName: "NAME (A-Z)",
                sortUrl: "URL",
                sortDate: "DATE ADDED",
                export: "EXPORT",
                import: "IMPORT",
                purge: "PURGE",
                addNode: "ADD NODE",
                labelName: "IDENTIFIER (Name):",
                labelUrl: "COORDINATES (URL):",
                labelIcon: "SYMBOL (Emoji):",
                btnExecute: "EXECUTE PROTOCOL",
                confirmDelete: "[SYSTEM ALERT] CONFIRM DELETION OF NODE?",
                confirmPurge: "[WARNING] PURGE ALL DATA? ACTION IRREVERSIBLE.",
                importSuccess: "[SYSTEM] DATABASE UPDATED SUCCESSFULLY.",
                importError: "[ERROR] CORRUPTED DATA FILE."
            },
            zh: {
                sysOnline: "[Á≥ªÁªüÂú®Á∫ø]",
                temp: "Ê∏©Â∫¶",
                env: "ÂÆûÈ™åÂÆ§ÁéØÂ¢É",
                searchPlaceholder: ">> ËæìÂÖ•Êåá‰ª§ÊàñÊêúÁ¥¢ÂÖ≥ÈîÆËØç...",
                searching: "Êï∞ÊçÆÊ£ÄÁ¥¢‰∏≠...",
                connecting: "[Ê≠£Âú®ËøûÊé•Â§ñÈÉ®ËäÇÁÇπ]",
                navTitle: "ÈìæÊé•Êï∞ÊçÆÂ∫ì",
                baidu: "ÁôæÂ∫¶",
                sortName: "ÂêçÁß∞ÊéíÂ∫è (A-Z)",
                sortUrl: "ÁΩëÂùÄÊéíÂ∫è",
                sortDate: "Ê∑ªÂä†Êó∂Èó¥",
                export: "ÂØºÂá∫Êï∞ÊçÆ",
                import: "ÂØºÂÖ•Êï∞ÊçÆ",
                purge: "Ê∏ÖÁ©∫ÂÖ®ÈÉ®",
                addNode: "Ê∑ªÂä†ËäÇÁÇπ",
                labelName: "Ê†áËØÜÁ¨¶ (ÂêçÁß∞):",
                labelUrl: "ÂùêÊ†á (ÁΩëÂùÄ):",
                labelIcon: "Á¨¶Âè∑ (Emoji):",
                btnExecute: "ÊâßË°åÂçèËÆÆ",
                confirmDelete: "[Á≥ªÁªüË≠¶Âëä] Á°ÆËÆ§Âà†Èô§Ê≠§ËäÇÁÇπÔºü",
                confirmPurge: "[Ë≠¶Âëä] Ê∏ÖÁ©∫ÊâÄÊúâÊï∞ÊçÆÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÈÄÜ„ÄÇ",
                importSuccess: "[Á≥ªÁªü] Êï∞ÊçÆÂ∫ìÊõ¥Êñ∞ÊàêÂäü„ÄÇ",
                importError: "[ÈîôËØØ] Êï∞ÊçÆÊñá‰ª∂ÊçüÂùè„ÄÇ"
            }
        };

        let currentLang = localStorage.getItem('lang') || 'en';

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'zh' : 'en';
            localStorage.setItem('lang', currentLang);
            applyLanguage();
            updateDate(); // Êõ¥Êñ∞Êó•ÊúüÊ†ºÂºè
        }

        function applyLanguage() {
            // Êõ¥Êñ∞ÊåâÈíÆÊñáÊú¨
            document.getElementById('langToggle').textContent = currentLang === 'en' ? '[ EN / ‰∏≠ ]' : '[ ‰∏≠ / EN ]';
            
            // Êõ¥Êñ∞ÊâÄÊúâÂ∏¶Êúâ data-i18n Â±ûÊÄßÁöÑÊñáÊú¨
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[currentLang][key]) {
                    el.textContent = translations[currentLang][key];
                }
            });

            // Êõ¥Êñ∞ input placeholder
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translations[currentLang][key]) {
                    el.placeholder = translations[currentLang][key];
                }
            });
        }

        // ==========================================
        // Á≤íÂ≠êËÉåÊôØÁâπÊïà
        // ==========================================
        const canvas = document.getElementById('canvas-background');
        const ctx = canvas.getContext('2d');
        let width, height;
        let particles = [];
        let mouse = { x: null, y: null };

        window.addEventListener('mousemove', (e) => { mouse.x = e.x; mouse.y = e.y; });
        window.addEventListener('mouseleave', () => { mouse.x = null; mouse.y = null; });
        window.addEventListener('resize', resize);

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            initParticles();
        }

        class Particle {
            constructor() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.z = Math.random() * 1.5 + 0.5;
                this.radius = Math.random() * 2;
                this.baseColor = `rgba(100, 116, 139, ${Math.random() * 0.4 + 0.1})`;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
            }
            update() {
                this.x += this.vx * this.z;
                this.y += this.vy * this.z;
                if (mouse.x != null) {
                    let dx = mouse.x - this.x;
                    let dy = mouse.y - this.y;
                    let distance = Math.sqrt(dx * dx + dy * dy);
                    if (distance < 150) {
                        const force = (150 - distance) / 150;
                        this.vx -= (dx / distance) * force * 0.05;
                        this.vy -= (dy / distance) * force * 0.05;
                    }
                }
                if (this.x < 0) this.x = width; if (this.x > width) this.x = 0;
                if (this.y < 0) this.y = height; if (this.y > height) this.y = 0;
            }
            draw() {
                ctx.beginPath(); ctx.arc(this.x, this.y, this.radius * this.z, 0, Math.PI * 2);
                ctx.fillStyle = this.baseColor; ctx.fill();
            }
        }

        function initParticles() {
            particles = [];
            const count = Math.floor(width * height / 20000);
            for (let i = 0; i < count; i++) particles.push(new Particle());
        }

        function drawConnections() {
            for (let i = 0; i < particles.length; i++) {
                for (let j = i + 1; j < particles.length; j++) {
                    const dx = particles[i].x - particles[j].x;
                    const dy = particles[i].y - particles[j].y;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    if (dist < 120 && Math.abs(particles[i].z - particles[j].z) < 0.3) {
                        ctx.beginPath();
                        ctx.strokeStyle = `rgba(0, 102, 255, ${0.05 * (1 - dist / 120)})`;
                        ctx.lineWidth = 0.5;
                        ctx.moveTo(particles[i].x, particles[i].y);
                        ctx.lineTo(particles[j].x, particles[j].y);
                        ctx.stroke();
                    }
                }
            }
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);
            particles.forEach(p => { p.update(); p.draw(); });
            drawConnections();
            requestAnimationFrame(animate);
        }

        resize(); animate();

        // ==========================================
        // Ê†∏ÂøÉÈÄªËæë
        // ==========================================
        let sites = []; 
        let currentSearchEngine = 'google';
        const searchEngines = {
            google: 'https://www.google.com/search?q=',
            baidu: 'https://www.baidu.com/s?wd=',
            bing: 'https://www.bing.com/search?q=',
            github: 'https://github.com/search?q='
        };

        // ÊâæÂà∞ËÑöÊú¨‰∏≠ÂéüÊù•ÁöÑ loadSitesData ÂáΩÊï∞ÔºåÊõøÊç¢‰∏∫Ëøô‰∏™ÁâàÊú¨Ôºö

async function loadSitesData() {
    try {
        // 1. ‰ºòÂÖàÂ∞ùËØï‰ªéÂ§ñÈÉ®Êñá‰ª∂/GitHubÂä†ËΩΩ
        // Ê≥®ÊÑèÔºöËøôÈúÄË¶Å‰Ω†ÁöÑÁΩëÁ´ôÈÉ®ÁΩ≤Âú®ÊúçÂä°Âô®‰∏äÔºàÂ¶ÇGitHub PagesÔºâÔºåÁõ¥Êé•ÂèåÂáªhtmlÊâìÂºÄÂèØËÉΩ‰ºöÂõ†‰∏∫Ë∑®ÂüüÊä•Èîô
        const response = await fetch('./data/sites.json'); 
        
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        
        const data = await response.json();
        // Â¶ÇÊûúÊàêÂäüËé∑ÂèñÂà∞Êï∞ÊçÆÔºåËøîÂõûÂÆÉ
        return Array.isArray(data) ? data : [];
        
    } catch (error) {
        console.warn('Êó†Ê≥ï‰ªéÊñá‰ª∂Âä†ËΩΩÊï∞ÊçÆÔºåËΩ¨‰∏∫ËØªÂèñÊú¨Âú∞Â≠òÂÇ®:', error);
        
        // 2. Â¶ÇÊûúÊñá‰ª∂Âä†ËΩΩÂ§±Ë¥•ÔºàÊàñËÄÖÁ¶ªÁ∫øÔºâÔºåÂàôËØªÂèñÊú¨Âú∞ LocalStorage
        const localSites = localStorage.getItem('sites');
        if (localSites) {
            return JSON.parse(localSites);
        }
        
        // 3. Â¶ÇÊûúÊú¨Âú∞‰πüÊ≤°Êï∞ÊçÆÔºåËøîÂõûÈªòËÆ§ÁöÑÊºîÁ§∫Êï∞ÊçÆ
        return [
            { name: 'Bilibili', url: 'https://bilibili.com', icon: 'üì∫', dateAdded: new Date().toISOString() },
            { name: 'GitHub', url: 'https://github.com', icon: 'üß¨', dateAdded: new Date().toISOString() }
        ];
    }
}


        document.addEventListener('DOMContentLoaded', async function() {
            applyLanguage(); // ÂàùÂßãÂåñËØ≠Ë®Ä
            sites = await loadSitesData();
            updateClock();
            updateDate();
            renderSites();
            setInterval(updateClock, 1000);
            setupEventListeners();
        });

        function updateClock() {
            const now = new Date();
            const pad = (n) => n < 10 ? '0' + n : n;
            document.getElementById('clock').textContent = `${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
        }

        function updateDate() {
            const now = new Date();
            let dateStr;
            if (currentLang === 'zh') {
                // ‰∏≠ÊñáÊ†ºÂºè: 10Êúà24Êó• Âë®Âõõ
                dateStr = now.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric', weekday: 'short' });
            } else {
                // Ëã±ÊñáÊ†ºÂºè: OCT 24, THU
                dateStr = now.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: '2-digit', weekday: 'short' }).toUpperCase();
            }
            document.getElementById('date').textContent = dateStr;
        }

        function setupEventListeners() {
            document.querySelectorAll('.search-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.search-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentSearchEngine = this.dataset.engine;
                });
            });

            const searchBox = document.getElementById('searchBox');
            searchBox.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const query = this.value.trim();
                    if (query) {
                        const overlay = document.getElementById('searchOverlay');
                        overlay.style.display = 'flex';
                        setTimeout(() => {
                            window.open(searchEngines[currentSearchEngine] + encodeURIComponent(query), '_blank');
                            overlay.style.display = 'none';
                            searchBox.value = ''; 
                        }, 800);
                    }
                }
            });

            document.getElementById('siteForm').addEventListener('submit', function(e) { e.preventDefault(); addSite(); });
            document.getElementById('sortSelect').addEventListener('change', function() { sortSites(this.value); });
            window.onclick = function(event) { if (event.target == document.getElementById('siteModal')) closeModal(); }
        }

        function renderSites() {
            const grid = document.getElementById('sitesGrid');
            const addButton = grid.querySelector('.add-site');
            grid.querySelectorAll('.site-card:not(.add-site)').forEach(card => card.remove());

            sites.forEach((site, index) => {
                grid.insertBefore(createSiteCard(site, index), addButton);
            });
        }

        function createSiteCard(site, index) {
            const card = document.createElement('div');
            card.className = 'site-card';
            let domain = '';
            try { domain = new URL(site.url).hostname; } catch(e) { domain = site.url; }
            
            card.innerHTML = `
                <div class="site-icon">${site.icon || 'üîó'}</div>
                <div class="site-name">${site.name}</div>
                <div class="site-url">${domain}</div>
            `;
            
            card.addEventListener('click', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    if (confirm(translations[currentLang].confirmDelete)) deleteSite(index);
                } else {
                    window.open(site.url, '_blank');
                }
            });
            return card;
        }

        function addSite() {
            const form = document.getElementById('siteForm');
            const formData = new FormData(form);
            let url = formData.get('siteUrl');
            if (!url.startsWith('http')) url = 'https://' + url;

            sites.push({
                name: formData.get('siteName'),
                url: url,
                icon: formData.get('siteIcon') || 'üîó',
                dateAdded: new Date().toISOString()
            });
            saveSitesToLocal(); renderSites(); closeModal(); form.reset();
        }

        function deleteSite(index) { sites.splice(index, 1); saveSitesToLocal(); renderSites(); }
        
        function sortSites(criteria) {
            sites.sort((a, b) => {
                if (criteria === 'name') return a.name.localeCompare(b.name);
                if (criteria === 'url') return a.url.localeCompare(b.url);
                return new Date(b.dateAdded) - new Date(a.dateAdded);
            });
            renderSites();
        }

        function saveSitesToLocal() { localStorage.setItem('sites', JSON.stringify(sites)); }
        
        function clearAllSites() {
            if(confirm(translations[currentLang].confirmPurge)) { sites = []; saveSitesToLocal(); renderSites(); }
        }

        function exportSites() {
            const url = URL.createObjectURL(new Blob([JSON.stringify(sites, null, 2)], {type: 'application/json'}));
            const link = document.createElement('a');
            link.href = url; link.download = 'nexus_backup.json'; link.click();
        }

        function importSites() {
            const input = document.createElement('input'); input.type = 'file'; input.accept = '.json';
            input.onchange = function(e) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        if(Array.isArray(data)) {
                            sites = data; saveSitesToLocal(); renderSites();
                            alert(translations[currentLang].importSuccess);
                        }
                    } catch (err) { alert(translations[currentLang].importError); }
                };
                reader.readAsText(e.target.files[0]);
            };
            input.click();
        }

        function openModal() {
            const modal = document.getElementById('siteModal');
            modal.style.display = 'block'; modal.offsetHeight; modal.classList.add('active');
        }
        function closeModal() {
            const modal = document.getElementById('siteModal');
            modal.classList.remove('active'); setTimeout(() => { modal.style.display = 'none'; }, 300);
        }
    </script>
</body>
</html>
